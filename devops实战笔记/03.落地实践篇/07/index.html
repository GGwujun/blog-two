<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog-two/umi.css" />
    <script>
      window.routerBase = "/blog-two";
    </script>
    <script>
      //! umi version: 3.5.17
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.indexOf(e) > -1 ? e : r[0]
        );
      })();
    </script>
    <title>11 | 分支策略：让研发高效协作的关键要素</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/devops实战笔记/03.落地实践篇/07" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-two/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>后端开发<ul><li><a href="/blog-two/go语言核心36讲">go语言核心36讲</a></li><li><a href="/blog-two/go并发编程实战">go并发编程实战</a></li><li><a href="/blog-two/零基础学python">零基础学python</a></li><li><a href="/blog-two/redis核心技术与实战">redis核心技术与实战</a></li><li><a href="/blog-two/redis源码剖析与实战">redis源码剖析与实战</a></li><li><a href="/blog-two/陈天rust编程第一课">陈天rust编程第一课</a></li><li><a href="/blog-two/tonybaigo语言第一课">tonybaigo语言第一课</a></li><li><a href="/blog-two/深入c语言和程序运行原理">深入c语言和程序运行原理</a></li></ul></span><span>架构师<ul><li><a href="/blog-two/持续交付36讲">持续交付36讲</a></li><li><a href="/blog-two/容器实战高手课">容器实战高手课</a></li><li><a href="/blog-two/ddd实战课">ddd实战课</a></li><li><a href="/blog-two/设计模式之美">设计模式之美</a></li><li><a aria-current="page" class="active" href="/blog-two/devops实战笔记">devops实战笔记</a></li><li><a href="/blog-two/架构实战案例解析">架构实战案例解析</a></li><li><a href="/blog-two/许式伟的架构课">许式伟的架构课</a></li><li><a href="/blog-two/高并发系统设计40问">高并发系统设计40问</a></li><li><a href="/blog-two/深入剖析kubernetes">深入剖析kubernetes</a></li><li><a href="/blog-two/说透中台">说透中台</a></li><li><a href="/blog-two/消息队列进阶">消息队列进阶</a></li><li><a href="/blog-two/mysql实战45讲">mysql实战45讲</a></li><li><a href="/blog-two/openresty从入门到实战">openresty从入门到实战</a></li><li><a href="/blog-two/赵成的运维体系管理课">赵成的运维体系管理课</a></li><li><a href="/blog-two/性能测试实战30讲">性能测试实战30讲</a></li><li><a href="/blog-two/安全攻防技能30讲">安全攻防技能30讲</a></li><li><a href="/blog-two/从0开始学架构">从0开始学架构</a></li><li><a href="/blog-two/vim实用技巧必知必会">vim实用技巧必知必会</a></li><li><a href="/blog-two/如何落地业务建模">如何落地业务建模</a></li><li><a href="/blog-two/技术与商业案例解读">技术与商业案例解读</a></li><li><a href="/blog-two/说透数字化转型">说透数字化转型</a></li><li><a href="/blog-two/遗留系统现代化实战">遗留系统现代化实战</a></li></ul></span><span>管理<ul><li><a href="/blog-two/技术管理实战36讲">技术管理实战36讲</a></li><li><a href="/blog-two/程序员进阶攻略">程序员进阶攻略</a></li><li><a href="/blog-two/项目管理实战课">项目管理实战课</a></li><li><a href="/blog-two/技术面试官识人手册">技术面试官识人手册</a></li><li><a href="/blog-two/技术领导力实战笔记">技术领导力实战笔记</a></li><li><a href="/blog-two/朱赟的技术管理">朱赟的技术管理</a></li></ul></span><span>工作生活<ul><li><a href="/blog-two/10x程序员工作法">10x程序员工作法</a></li><li><a href="/blog-two/python自动化办公实战课">python自动化办公实战课</a></li><li><a href="/blog-two/人人都用得上的写作课">人人都用得上的写作课</a></li><li><a href="/blog-two/体验设计案例课">体验设计案例课</a></li><li><a href="/blog-two/用户体验设计实战课">用户体验设计实战课</a></li><li><a href="/blog-two/程序员的个人财富课">程序员的个人财富课</a></li><li><a href="/blog-two/程序员进阶攻略">程序员进阶攻略</a></li><li><a href="/blog-two/职场求生攻略">职场求生攻略</a></li><li><a href="/blog-two/讲好故事">讲好故事</a></li><li><a href="/blog-two/跟着高手学复盘">跟着高手学复盘</a></li></ul></span><span>杂谈</span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-two/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>后端开发<ul><li><a href="/blog-two/go语言核心36讲">go语言核心36讲</a></li><li><a href="/blog-two/go并发编程实战">go并发编程实战</a></li><li><a href="/blog-two/零基础学python">零基础学python</a></li><li><a href="/blog-two/redis核心技术与实战">redis核心技术与实战</a></li><li><a href="/blog-two/redis源码剖析与实战">redis源码剖析与实战</a></li><li><a href="/blog-two/陈天rust编程第一课">陈天rust编程第一课</a></li><li><a href="/blog-two/tonybaigo语言第一课">tonybaigo语言第一课</a></li><li><a href="/blog-two/深入c语言和程序运行原理">深入c语言和程序运行原理</a></li></ul></li><li>架构师<ul><li><a href="/blog-two/持续交付36讲">持续交付36讲</a></li><li><a href="/blog-two/容器实战高手课">容器实战高手课</a></li><li><a href="/blog-two/ddd实战课">ddd实战课</a></li><li><a href="/blog-two/设计模式之美">设计模式之美</a></li><li><a aria-current="page" class="active" href="/blog-two/devops实战笔记">devops实战笔记</a></li><li><a href="/blog-two/架构实战案例解析">架构实战案例解析</a></li><li><a href="/blog-two/许式伟的架构课">许式伟的架构课</a></li><li><a href="/blog-two/高并发系统设计40问">高并发系统设计40问</a></li><li><a href="/blog-two/深入剖析kubernetes">深入剖析kubernetes</a></li><li><a href="/blog-two/说透中台">说透中台</a></li><li><a href="/blog-two/消息队列进阶">消息队列进阶</a></li><li><a href="/blog-two/mysql实战45讲">mysql实战45讲</a></li><li><a href="/blog-two/openresty从入门到实战">openresty从入门到实战</a></li><li><a href="/blog-two/赵成的运维体系管理课">赵成的运维体系管理课</a></li><li><a href="/blog-two/性能测试实战30讲">性能测试实战30讲</a></li><li><a href="/blog-two/安全攻防技能30讲">安全攻防技能30讲</a></li><li><a href="/blog-two/从0开始学架构">从0开始学架构</a></li><li><a href="/blog-two/vim实用技巧必知必会">vim实用技巧必知必会</a></li><li><a href="/blog-two/如何落地业务建模">如何落地业务建模</a></li><li><a href="/blog-two/技术与商业案例解读">技术与商业案例解读</a></li><li><a href="/blog-two/说透数字化转型">说透数字化转型</a></li><li><a href="/blog-two/遗留系统现代化实战">遗留系统现代化实战</a></li></ul></li><li>管理<ul><li><a href="/blog-two/技术管理实战36讲">技术管理实战36讲</a></li><li><a href="/blog-two/程序员进阶攻略">程序员进阶攻略</a></li><li><a href="/blog-two/项目管理实战课">项目管理实战课</a></li><li><a href="/blog-two/技术面试官识人手册">技术面试官识人手册</a></li><li><a href="/blog-two/技术领导力实战笔记">技术领导力实战笔记</a></li><li><a href="/blog-two/朱赟的技术管理">朱赟的技术管理</a></li></ul></li><li>工作生活<ul><li><a href="/blog-two/10x程序员工作法">10x程序员工作法</a></li><li><a href="/blog-two/python自动化办公实战课">python自动化办公实战课</a></li><li><a href="/blog-two/人人都用得上的写作课">人人都用得上的写作课</a></li><li><a href="/blog-two/体验设计案例课">体验设计案例课</a></li><li><a href="/blog-two/用户体验设计实战课">用户体验设计实战课</a></li><li><a href="/blog-two/程序员的个人财富课">程序员的个人财富课</a></li><li><a href="/blog-two/程序员进阶攻略">程序员进阶攻略</a></li><li><a href="/blog-two/职场求生攻略">职场求生攻略</a></li><li><a href="/blog-two/讲好故事">讲好故事</a></li><li><a href="/blog-two/跟着高手学复盘">跟着高手学复盘</a></li></ul></li><li>杂谈</li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog-two/devops实战笔记">devops实战笔记</a></li><li><a href="/blog-two/devops实战笔记/01.开篇词">01.开篇词</a><ul><li><a href="/blog-two/devops实战笔记/01.开篇词/01"><span>开篇词 | 从默默无闻到风靡全球，DevOps究竟有什么魔力？</span></a></li></ul></li><li><a href="/blog-two/devops实战笔记/02.基础理论篇">02.基础理论篇</a><ul><li><a href="/blog-two/devops实战笔记/02.基础理论篇/01"><span>01 | DevOps的“定义”：DevOps究竟要解决什么问题？</span></a></li><li><a href="/blog-two/devops实战笔记/02.基础理论篇/02"><span>02 | DevOps的价值：数字化转型时代，DevOps是必选项？</span></a></li><li><a href="/blog-two/devops实战笔记/02.基础理论篇/03"><span>03 | DevOps的实施：到底是工具先行还是文化先行？</span></a></li><li><a href="/blog-two/devops实战笔记/02.基础理论篇/04"><span>04 | DevOps的衡量：你是否找到了DevOps的实施路线图？</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog-two/devops实战笔记/03.落地实践篇">03.落地实践篇</a><ul><li><a href="/blog-two/devops实战笔记/03.落地实践篇/01"><span>05 | 价值流分析：关于DevOps转型，我们应该从何处入手？</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/02"><span>06 | 转型之路：企业实施DevOps的常见路径和问题</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/03"><span>07 | 业务敏捷：帮助DevOps快速落地的源动力</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/04"><span>08 | 精益看板（上）：精益驱动的敏捷开发方法</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/05"><span>09 | 精益看板（下）：精益驱动的敏捷开发方法</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/06"><span>10 | 配置管理：最容易被忽视的DevOps工程实践基础</span></a></li><li><a aria-current="page" class="active" href="/blog-two/devops实战笔记/03.落地实践篇/07"><span>11 | 分支策略：让研发高效协作的关键要素</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/08"><span>12 | 持续集成：你说的CI和我说的CI是一回事吗？</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/09"><span>13 | 自动化测试：DevOps的阿克琉斯之踵</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/10"><span>14 | 内建质量：丰田和亚马逊给我们的启示</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/11"><span>15 | 技术债务：那些不可忽视的潜在问题</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/12"><span>16 | 环境管理：一切皆代码是一种什么样的体验？</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/13"><span>17 | 部署管理：低风险的部署发布策略</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/14"><span>18 | 混沌工程：软件领域的反脆弱</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/15"><span>19 | 正向度量：如何建立完整的DevOps度量体系？</span></a></li><li><a href="/blog-two/devops实战笔记/03.落地实践篇/16"><span>20 | 持续改进：PDCA体系和持续改进的意义</span></a></li></ul></li><li><a href="/blog-two/devops实战笔记/04.平台工具篇">04.平台工具篇</a><ul><li><a href="/blog-two/devops实战笔记/04.平台工具篇/01"><span>21 | 开源还是自研：企业DevOps平台建设的三个阶段</span></a></li><li><a href="/blog-two/devops实战笔记/04.平台工具篇/02"><span>22 | 产品设计之道：DevOps产品设计的五个层次</span></a></li><li><a href="/blog-two/devops实战笔记/04.平台工具篇/03"><span>23 | 持续交付平台：现代流水线必备的十大特征（上）</span></a></li><li><a href="/blog-two/devops实战笔记/04.平台工具篇/04"><span>24 | 持续交付平台：现代流水线必备的十大特征（下）</span></a></li><li><a href="/blog-two/devops实战笔记/04.平台工具篇/05"><span>25 | 让数据说话：如何建设企业级数据度量平台？</span></a></li><li><a href="/blog-two/devops实战笔记/04.平台工具篇/06"><span>26 | 平台产品研发：三个月完成千人规模的产品要怎么做？</span></a></li><li><a href="/blog-two/devops实战笔记/04.平台工具篇/07"><span>27 | 巨人的肩膀：那些你不能忽视的开源工具</span></a></li><li><a href="/blog-two/devops实战笔记/04.平台工具篇/08"><span>28 | 迈向云端：云原生应用时代的平台思考</span></a></li></ul></li><li><a href="/blog-two/devops实战笔记/05.转型案例篇">05.转型案例篇</a><ul><li><a href="/blog-two/devops实战笔记/05.转型案例篇/01"><span>29 | 向前一步：万人规模企业的DevOps实战转型案例（上）</span></a></li><li><a href="/blog-two/devops实战笔记/05.转型案例篇/02"><span>30 | 向前一步：万人规模企业的DevOps实战转型案例（下）</span></a></li></ul></li><li><a href="/blog-two/devops实战笔记/06.特别放送">06.特别放送</a><ul><li><a href="/blog-two/devops实战笔记/06.特别放送/01"><span>特别放送（一）| 成为DevOps工程师的必备技能（上）</span></a></li><li><a href="/blog-two/devops实战笔记/06.特别放送/02"><span>特别放送（二）| 成为DevOps工程师的必备技能（下）</span></a></li><li><a href="/blog-two/devops实战笔记/06.特别放送/03"><span>特别放送（三）| 学习DevOps不得不了解的经典资料</span></a></li><li><a href="/blog-two/devops实战笔记/06.特别放送/04"><span>特别放送（四）| Jenkins产品经理是如何设计产品的？</span></a></li><li><a href="/blog-two/devops实战笔记/06.特别放送/05"><span>特别放送（五）| 关于DevOps组织和文化的那些趣事儿</span></a></li></ul></li><li><a href="/blog-two/devops实战笔记/07.总结答疑篇">07.总结答疑篇</a><ul><li><a href="/blog-two/devops实战笔记/07.总结答疑篇/01"><span>期中总结 | 3个典型问题答疑及如何高效学习</span></a></li><li><a href="/blog-two/devops实战笔记/07.总结答疑篇/02"><span>期末总结 | 在云时代，如何选择一款合适的流水线工具？</span></a></li></ul></li><li><a href="/blog-two/devops实战笔记/08.结束语">08.结束语</a><ul><li><a href="/blog-two/devops实战笔记/08.结束语/01"><span>结束语 | 持续改进，成就非凡！</span></a></li><li><a href="/blog-two/devops实战笔记/08.结束语/02"><span>结课问卷获奖用户名单</span></a></li><li><a href="/blog-two/devops实战笔记/08.结束语/03"><span>期末测试 | 这些DevOps核心知识，你都掌握了吗？</span></a></li></ul></li><li><a href="/blog-two/devops实战笔记/summary">devops实战笔记</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="主干开发，分支发布" data-depth="2"><a href="/blog-two/devops实战笔记/03.落地实践篇/07#主干开发分支发布"><span>主干开发，分支发布</span></a></li><li title="分支开发，主干发布" data-depth="2"><a href="/blog-two/devops实战笔记/03.落地实践篇/07#分支开发主干发布"><span>分支开发，主干发布</span></a></li><li title="主干开发，主干发布" data-depth="2"><a href="/blog-two/devops实战笔记/03.落地实践篇/07#主干开发主干发布"><span>主干开发，主干发布</span></a></li><li title="总结" data-depth="2"><a href="/blog-two/devops实战笔记/03.落地实践篇/07#总结"><span>总结</span></a></li><li title="思考题" data-depth="2"><a href="/blog-two/devops实战笔记/03.落地实践篇/07#思考题"><span>思考题</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="11--分支策略让研发高效协作的关键要素"><a aria-hidden="true" tabindex="-1" href="/blog-two/devops实战笔记/03.落地实践篇/07#11--分支策略让研发高效协作的关键要素"><span class="icon icon-link"></span></a>11 | 分支策略：让研发高效协作的关键要素</h1><p>你好，我是石雪峰。今天我们来聊聊分支策略。</p><p>在上一讲中，我反复强调过一个理念，那就是将一切纳入版本控制。其实，现代版本控制系统不仅可以记录版本和变更记录，还有一个非常重要的功能，那就是<strong>分支管理</strong>。</p><p>现代软件开发讲究效率和质量，大多依赖于多团队间的协作来实现。对于一些大型软件来说，即便是百人团队规模的协作也没什么奇怪的。如果软件架构没有良好的拆分，很有可能出现几百人在一个代码仓库里面工作的情况。这时，分支管理就成了不可或缺的功能。</p><p>一方面，分支可以隔离不同开发人员的改动，给他们提供一个相对独立的空间，让他们能够完成自己的开发任务。另一方面，整个团队也需要根据软件的发布节奏来完成代码提交、审核、集成、测试等工作。</p><p>所以，如果说多人软件协作项目中有一个灵魂的话，我认为，这个灵魂就是分支策略。可以说，<strong>分支策略就是软件协作模式和发布模式的风向标</strong>。选择一种符合DevOps开发模式的分支策略，对于DevOps的实践落地也会大有帮助。</p><p>今天，我会给你拆解一些常见的分支策略，帮你了解这些策略的核心流程、优缺点，以及适用的场景和案例。</p><h2 id="主干开发分支发布"><a aria-hidden="true" tabindex="-1" href="/blog-two/devops实战笔记/03.落地实践篇/07#主干开发分支发布"><span class="icon icon-link"></span></a>主干开发，分支发布</h2><p><img src="https://static001.geekbang.org/resource/image/71/85/717a85f005b8da0b593d6376db679685.png" alt=""/></p><blockquote><p>图片来源：<br/><a target="_blank" rel="noopener noreferrer" href="https://paulhammant.com/2013/12/04/what_is_your_branching_model/">https://paulhammant.com/2013/12/04/what_is_your_branching_model/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><p>在这种分支策略下，开发团队共享一条主干分支，所有的代码都直接提交到主干分支上，主干分支就相当于是一个代码的全量合集。<strong>在软件版本发布之前，会基于主干拉出一条以发布为目的的短分支</strong>。</p><p>你需要注意一下这句话里的两个关键词：</p><ol><li><strong>以发布为目的</strong>。这条分支存在的意义不是开发新功能，而是对现有功能进行验收，并在达到一定的质量标准后对外发布。一般来说，新功能不会基于这条分支提交，只有一些Bugfix会集成进来。所以，对于这种发布分支会有比较严格的权限管控。毕竟，谁都不想让那些乱七八糟、未经验证的功能跑到发布分支上来。</li><li><strong>短分支</strong>。这条发布分支一般不会存在太长时间，只要经过回归验证，满足发布标准后，就可以直接对外发布，这时，这条分支的历史使命也就结束了。除非上线之后发现一些紧急问题需要修复，才会继续在这条分支上修改验证，并将改动同步回主干分支。所以，只要在主干分支和发布分支并行存在的时间段内，所有发布分支上的改动都需要同步回主分支，这也是我们不希望这条分支存在时间过长的原因，因为这会导致重复工作量的线性累计。</li></ol><p>对于以版本节奏驱动的软件项目来说，这种分支策略非常常见，比如客户端产品，或者是那种需要在客户终端升级的智能硬件产品，像智能手机、智能电视等。</p><p>早在很多年前，乐视刚刚推出超级电视的时候，喊过一个口号叫“周周更新”。要知道，当时智能电视产品的更新频率普遍是几个月一次。</p><p>其实，如果你了解分支策略的话，你就会发现，“周周更新”的背后也没什么特别的。当时，我所在的团队恰好负责智能电视产品线的分支策略，采用的就是主干开发、分支发布的模式。其中基于主干的发布分支提前两周拉出，然后在发布分支上进行回归验证，并在第一周发出体验版本给喜欢尝鲜的用户试用。然后，根据用户反馈和后台收集的问题进行进一步修正，并最终发布一个稳定版本。我把当时的分支策略图分享给你，你可以参考一下。</p><p><img src="https://static001.geekbang.org/resource/image/e0/46/e05c3b28341b3c99cceb3b916f5e7046.jpg" alt=""/></p><p>这种模式的优势有三个：</p><ol><li>对于研发团队来说，只有一条主线分支，不需要在多条分支间切换。</li><li>在发布分支拉出之后，主干分支依然处于可集成状态，研发节奏可以保持在一个相对平稳的状态。</li><li>发布分支一般以版本号命名，清晰易懂，线上哪个版本出了问题，就在哪个分支上修复。</li></ol><p>不过，这种模式也存在着缺点和挑战：</p><ol><li><strong>它对主线分支的质量要求很高</strong>。如果主线分支出了问题，就会block所有开发团队的工作。对于一个百人团队、每日千次的提交规模来说，如果不对提交加以约束，这种情况的发生频率就会非常高。</li><li><strong>它对团队协作的节奏要求很高</strong>。如果主线分支上的功能没有及时合入，但是业务方又坚持要在指定版本上线这个功能，这就会导致发布分支“难产”。甚至有些时候，会被迫允许部分未开发完成的功能在发布分支上继续开发，这会给发布分支的质量和稳定性造成很大的挑战。</li><li><strong>在主线和发布分支并存期间，有可能会导致两边提交不同步的情况</strong>。比如，发布分支修复了一个线上问题，但是由于没有同步回主线，导致同样的问题在下一个版本中复现。测试出来的问题越多，这种情况出现的概率就越大，更不要说多版本并存的情况了。</li></ol><p>这些问题的解决方法包括以下几点：</p><ol><li>建立提交的准入门禁，不允许不符合质量标准的代码合入主线。</li><li>采用版本火车的方式，加快版本的迭代速度，功能“持票上车”，如果跟不上这个版本就随下个版本上线。另外，可以采用功能开关、热修复等手段，打破版本发布的固定节奏，以一种更加灵活的方式对外发布。</li><li>通过自动化手段扫描主线和发布分支的差异，建立一种规则。比如Hotfix必须主线和发布分支同时提交，或者发布分支上线后，由专人反向同步等。</li></ol><h2 id="分支开发主干发布"><a aria-hidden="true" tabindex="-1" href="/blog-two/devops实战笔记/03.落地实践篇/07#分支开发主干发布"><span class="icon icon-link"></span></a>分支开发，主干发布</h2><p><img src="https://static001.geekbang.org/resource/image/b9/69/b956a9dc626cad58976b55c5cb773169.png" alt=""/></p><blockquote><p>图片来源：<a target="_blank" rel="noopener noreferrer" href="https://paulhammant.com/2013/12/04/what_is_your_branching_model/">https://paulhammant.com/2013/12/04/what_is_your_branching_model/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><p>当开发接到一个任务后，会基于主干拉出一条特性开发分支，在特性分支上完成功能开发验证之后，通过Merge request或者Pull request的方式发起合并请求，在评审通过后合入主干，并在主干完成功能的回归测试。开源社区流行的GitHub模式其实就是属于这种。</p><p>根据特性和团队的实际情况，还可以进一步细分为两种情况：</p><ul><li>每条特性分支以特性编号或需求编号命名，在这条分支上，只完成一个功能的开发；</li><li>以开发模块为单位，拉出一条长线的特性分支，并在这条分支上进行开发协作。</li></ul><p><strong>两者的区别就在于特性分支存活的周期，拉出时间越长，跟主干分支的差异就越大，分支合并回去的冲突也就越大</strong>。所以，对于长线模式来说，要么是模块拆分得比较清晰，不会有其他人动这块功能，要么就是保持同主干的频繁同步。<strong>随着需求拆分粒度的变小，短分支的方式其实更合适</strong>。</p><p>这种模式下的优势也有两点：</p><ol><li><strong>分支开发相对比较独立，不会因为并行导致互相干扰</strong>。同时，特性只有在开发完成并验收通过后才会合入主干，对主干分支的质量起到了保护作用；</li><li>随着特性分支的流行，在这种模式下，分支成了特性天然的载体。一个特性所关联的所有代码可以保存在一条特性分支上，这为以特性为粒度进行发布的模式来说提供了一种新的可能性。也就是说，如果你想要发布哪个特性，就可以直接将特性分支合并到发布分支上，这就让某一个特性变得“可上可下”，而不是混在一大堆代码当中，想拆也拆不出来。</li></ol><p>关于这种特性分支发布的方法，我给你提供一份<a target="_blank" rel="noopener noreferrer" href="https://mp.weixin.qq.com/s/JsBX3UPgZL_HUOTCIopr_A">参考资料<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，你可以了解一下。不过，我想提醒你的是，特性发布虽然看起来很好，但是有三个前置条件：第一个是<strong>特性拆分得足够小</strong>，第二是<strong>有强大的测试环境作支撑</strong>，可以满足灵活的特性组合验证需求，第三是<strong>要有一套自动化的特性管理工具</strong>。</p><p>当然，分支开发、主干发布的模式也有缺点和挑战：</p><ol><li>非常考验团队特性拆分的能力。如果一个特性过大，会导致大量并行开发的分支存在，分支的集成周期拉长，潜在的冲突也会增多。另外，分支长期存在也会造成跟主线差异过大的问题。所以，<strong>特性的粒度和分支存活的周期是关键要素。根据经验来看，分支存活的周期一般不要超过一周</strong>。</li><li>对特性分支的命名规范要求很高。由于大量特性分支的拉出，整个代码仓库会显得非常乱。面对一大堆分支，谁也说不清到底哪个还活着，哪个已经没用了。所以，如果能够跟变更管理系统打通，自动化创建分支就最好了。</li><li>特性分支的原子性和完整性，保证一个特性的关联改动需要提交到一条分支上，而不是到处都是。同时，特性分支上的提交也需要尽量清晰，典型的就是原子性提交。</li></ol><p>我之前所在的一个团队就是采用的这种分支策略。有一次，我为了分支策略的执行细节跟研发负责人争得面红耳赤，争论的核心点就是：当特性分支合并回主干的时候，到底要不要对特性分支上的代码进行整理？</p><p>只要做过开发，你就会知道，很少有人能只用一次提交就把代码写对的，因为总是会有这样那样的问题，导致特性分支上的提交乱七八糟。</p><p>在合入主干的时候，为了保证代码的原子性，其实是有机会对代码提交进行重新编排的，Git在这方面可以说非常强大。如果你熟练掌握git rebase命令，就可以快速合并分拆提交，将每一个提交整理为有意义的原子性的提交，再合入主干，或者干脆把特性分支上的改动压合成一个提交。当然，这样做的代价就是不断重写特性分支的历史，给研发团队带来额外的工作量。我跟你分享一些常见的命令。</p><blockquote><p>比如：当前特性分支feature1，主分支master，那么，你可以执行以下命令整理提交历史：</p></blockquote><blockquote><p>git checkout feature1 &amp;&amp; git fetch origin &amp;&amp; git rebase -i origin/master</p></blockquote><blockquote><p><img src="https://static001.geekbang.org/resource/image/b7/1b/b709ba3701064f950534eb93d822731b.png" alt=""/></p></blockquote><blockquote><p>最常见的操作包括：<br/>p：选择提交；<br/>r：更新提交的注释信息；<br/>e：编辑提交，可以将一个提交拆分成多个；<br/>s：压合提交，将多个提交合并成一个；<br/>f：类似压合提交，但是放弃这个提交的注释信息，直接使用合并提交的注释信息；<br/>当然，在git rebase的交互界面中，你也可以调整提交的顺序，比如将特性功能和关联的Bugfix整合在一起。</p></blockquote><p><strong>需要提醒你的是，分支策略代表了研发团队的行为准则，每个团队都需要磨合出一套适合自己的模式来</strong>。</p><h2 id="主干开发主干发布"><a aria-hidden="true" tabindex="-1" href="/blog-two/devops实战笔记/03.落地实践篇/07#主干开发主干发布"><span class="icon icon-link"></span></a>主干开发，主干发布</h2><p><img src="https://static001.geekbang.org/resource/image/8f/b0/8f1b96d9847430effaba8d5ee45d8bb0.png" alt=""/></p><blockquote><p>图片来源：<a target="_blank" rel="noopener noreferrer" href="https://paulhammant.com/2013/12/04/what_is_your_branching_model/">https://paulhammant.com/2013/12/04/what_is_your_branching_model/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><p>今天给你介绍的第三种分支策略是主干开发、主干发布。武学高手修炼到一定境界之后，往往会发现大道至简，分支策略也是如此。所以，第三种分支策略可以简单理解为没有策略。<strong>团队只有一条分支，开发人员的代码改动都直接集成到这条主干分支上，同时，软件的发布也基于这条主干分支进行</strong>。</p><p>对于持续交付而言，最理想的情况就是，每一次提交都能经历一系列的自动化环境并部署到生产环境上面，而这种模式距离这个目标就更近了一点。</p><p>可想而知，如果想要做到主干分支在任何时间都处于可发布状态，那么，这就对每一次提交的代码质量要求非常高。</p><p>在一些追求工程卓越的公司里，你要提交一行代码，就必须经历“九九八十一难”，因为有一系列的自动化验收手段，还有极为严格的代码评审机制来保证你的提交不会把主干分支搞挂掉。当然，即便如此，问题也是难以避免的，那我们该怎么做呢？这里我就要给你介绍下Facebook的分支策略演进案例了。</p><p>Facebook最早采用的也是主干开发、分支发布的策略，每天固定发布两次。但是，随着业务发展的压力增大，团队对于发布频率有了更高的要求，这种分支策略已经无法满足每天多次发布的需求了。于是，他们开始着手改变分支策略，从主干开发、分支发布的模式，演变成了主干开发、主干发布的模式。</p><p>为了保证主干分支的质量，自动化验收手段是必不可少的，因此，每一次代码提交都会触发完整的编译构建、单元测试、代码扫描、自动化测试等过程。在代码合入主干后，会进行按需发布，先是发布到内部环境，也就是只有Facebook的员工才能看到这个版本，如果发现问题就立刻修复，如果没有问题，再进一步开放发布给2%的线上生产用户，同时自动化检测线上的反馈数据。直到确认一切正常，才会对所有用户开放。</p><p>最后，通过分支策略和发布策略的整合，注入自动化质量验收和线上数据反馈能力，最终将发布频率从固定的每天2次，提升到每天多次，甚至实现了按需发布的模式。Facebook最新的分支策略如图所示：</p><p><img src="https://static001.geekbang.org/resource/image/b2/64/b2a7a2d841e5b95d1fbf83d286d42364.jpg" alt=""/></p><blockquote><p>图片来源：<a target="_blank" rel="noopener noreferrer" href="https://engineering.fb.com/web/rapid-release-at-massive-scale/">https://engineering.fb.com/web/rapid-release-at-massive-scale/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><p>看到这里，你可能会问：“在这三种典型策略中，哪种策略是最好的？我应该如何选择呢？”其实，这个问题也困扰着很多公司。</p><p>的确，不同类型、规模、行业的软件项目采用的分支策略可能都不尽相同，同时，发布频率、软件架构、基础设施能力、人员能力水平等因素也在制约着分支策略的应用效果。</p><p>所以，很难说有一种通用的分支策略可以满足所有场景的需求。但是，有些分支策略的原则更加适合于快速迭代发布的场景，也就更加适合DevOps的发展趋势。所以，我个人比较推荐的是<strong>主干开发结合特性分支的模式</strong>，也就是团队共享一条开发主干，特性开发基于主干拉出特性分支，快速开发验收并回归主干，同时，在特性分支和主干分别建立不同的质量门禁和自动化验收能力。</p><p>这样做的好处在于，<strong>可以加快代码集成频率，特性相对独立清晰</strong>，并且主干分支又可以保持一定的质量水平。不过，在执行的过程中，你需要遵守以下原则：</p><ol><li>团队共享一条主干分支；</li><li>特性分支的存活周期要尽量短，最好不要超过3天；</li><li>每天向主干合并一次代码，如果特性分支存在超过1天，那么每天都要同步主干代码；</li><li>谨慎使用功能开关等技术手段，保持代码干净和历史清晰；</li><li>并行分支越少越好，如果可能的话，尽量采用主干发布。</li></ol><p>关于最后一条，你需要注意的是，<strong>是否需要发布分支，主要取决于项目的发布模式</strong>。对于按照版本方式发布的项目来说，比如App、智能硬件系统，以及依赖大量外部系统联调的核心系统，可以按照发布固定的节奏拉出发布分支；对于发布节奏较快、系统架构拆分后相对独立的应用来说，可以直接采用主干发布的模式，并结合安全发布策略把控整体的发布质量。</p><p>这种分支发布的策略图如下所示：</p><p><img src="https://static001.geekbang.org/resource/image/16/5e/165381a31f212516ee92fd295040465e.jpg" alt=""/></p><h2 id="总结"><a aria-hidden="true" tabindex="-1" href="/blog-two/devops实战笔记/03.落地实践篇/07#总结"><span class="icon icon-link"></span></a>总结</h2><p>今天，我给你介绍了三种分支策略，建议你对照我给你分享的分支策略图，好好理解一下。另外， 我还介绍了适合DevOps模式的分支策略以及一些使用原则。还记得我最开始说的吗？分支策略就是研发协作和发布模式的风向标，分支策略的变化对整个研发团队的习惯和节奏都是一个非常大的调整，找到适合当前团队的分支策略，才是最重要的。</p><h2 id="思考题"><a aria-hidden="true" tabindex="-1" href="/blog-two/devops实战笔记/03.落地实践篇/07#思考题"><span class="icon icon-link"></span></a>思考题</h2><p>你目前所在的团队采用的是哪种分支策略？你觉得当前的分支策略有哪些问题或改进空间吗？你是否经历过分支策略的调整呢？如果有的话，你在这个过程中踩过什么“坑”吗？有没有什么心得呢？</p><p>欢迎在留言区写下你的思考和答案，我们一起讨论，共同学习进步。如果你觉得这篇文章对你有所帮助，欢迎你把文章分享给你的朋友。</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/docs/devops实战笔记/03.落地实践篇/07.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">5/2/2022 02:41:01</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog-two/umi.js"></script>
  </body>
</html>
